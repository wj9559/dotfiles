#!/usr/bin/env bash

TODOFILE=~/.todo

if [[ ! -f $TODOFILE ]]; then
    touch $TODOFILE
fi

usage(){
echo "Usage: todo [todo]
simple todo list
  -h, --help            display this help and exit
  -l, --list            display the todo-list
  -s, --show            display the specified row in the todo-list
  -r, --remove          remove an item from the todo-list
  -e, --edit            direct edit todo.file
  --clear               clear the todo-list
  other                 add an item to the todo-list"
exit 0
}

remove(){
    nl $TODOFILE
    eval printf %.0s- {1..${COLUMNS:-$(tput cols)}}; echo
    read -p "Type a number to remove: " number
    sed -i ${number}d $TODOFILE
}

write(){
    printf "%s\n" "$*" >> $TODOFILE
    sed -i "/^$/d" $TODOFILE
}

case ${1} in
""              ) echo -e "  -h|--help          display help\n" && nl $TODOFILE;;
-h|--help       ) usage;;
-l|--list       ) nl $TODOFILE;;
-s|--show       ) sed -n ${2}p $TODOFILE;;
-r|--remove     ) remove;;
-e|--edit       ) ${EDITOR:-nano} $TODOFILE;;
--clear         ) > $TODOFILE;;
*               ) write $*;;
esac
