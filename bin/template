#!/usr/bin/env bash
# author: wujian(github.com/wj9559)

_usage() {
echo "\
Usage: template [filename.filetype]...
create file by template. Templates in ~/Templates
  list [default]
  -h, --help			display this help and exit"
}
[[ $1 == "-h" || $1 == "--help" ]] && _usage && exit

list() {
echo "-h, --help,		display this help and exit"
echo
echo "Templates list:"
ls ~/Templates/
}

create() {
name=$(echo $1 | cut -d. -f1)
type=$(echo $1 | cut -d. -f2)
cp ~/Templates/$type $1 &> /dev/null

if [[ $? -eq 0 ]]; then
	echo "create '$1'"
else
	echo "please create '.$type' Templates" >&2
	return 2
fi
}

exitcode=0

createForeach() {
for i in $@; do
create $i
[[ $? == 2 ]] && let exitcode++
done
}

select=${1:-list}
case $select in
list ) list;;
*    ) createForeach $@;;
esac

if [[ $exitcode != 0 ]]; then
    exit $exitcode
elif [[ $# == 1 ]]; then
    rifle $1
fi
